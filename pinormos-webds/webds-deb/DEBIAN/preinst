#!/bin/sh

# Pre-installation shell script for Debian package

USER=dsdkuser
WORKSPACE=/home/$USER/jupyter/workspace
SYNADIR=$WORKSPACE/Synaptics
PACKRATDIR=$WORKSPACE/Packrat

# Uninstall WebDS extensions
pip3 freeze | grep webds | xargs -r sudo pip3 uninstall -y

sudo rm -fr $WORKSPACE/packrat

# Set up Packrat directory within JupyterLab workspace
if [ ! -d "$PACKRATDIR" ]; then
  sudo install -d -o $USER -g $USER $PACKRATDIR
fi

sudo rm -fr $SYNADIR

# Set up Synaptics directory within JupyterLab workspace
if [ ! -d "$SYNADIR" ]; then
  sudo mkdir -p $SYNADIR/Documentation/Specifications/TouchComm_Protocol
  sudo mkdir -p $SYNADIR/Documentation/User_Guides/AsicProgrammer
  sudo mkdir -p $SYNADIR/Documentation/User_Guides/TouchComm
  sudo mkdir -p $SYNADIR/Sample_Code
  sudo mkdir -p $SYNADIR/Sample_Code/Carme_Gear_Selection
  sudo mkdir -p $SYNADIR/_links
  sudo chmod -R 755 $SYNADIR
  sudo install -d -o $USER -g $USER $SYNADIR/.ipynb_checkpoints
  sudo install -d -o $USER -g $USER $SYNADIR/Documentation/Specifications/TouchComm_Protocol/.ipynb_checkpoints
  sudo install -d -o $USER -g $USER $SYNADIR/Documentation/User_Guides/AsicProgrammer/.ipynb_checkpoints
  sudo install -d -o $USER -g $USER $SYNADIR/Documentation/User_Guides/TouchComm/.ipynb_checkpoints
  sudo install -d -o $USER -g $USER $SYNADIR/Sample_Code/.ipynb_checkpoints
  sudo install -d -o $USER -g $USER $SYNADIR/Sample_Code/Carme_Gear_Selection/.ipynb_checkpoints
  sudo install -d -o $USER -g $USER $SYNADIR/_links/.ipynb_checkpoints
fi
